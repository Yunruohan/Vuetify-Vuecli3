{"remainingRequest":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js!/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dmsun/Desktop/workspace/solar/src/pages/welfare/views/common/BannerAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dmsun/Desktop/workspace/solar/src/pages/welfare/views/common/BannerAdd.vue","mtime":1547889925000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/Users/dmsun/Desktop/workspace/solar/node_modules/@babel/runtime/regenerator\";\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } } function _next(value) { step(\"next\", value); } function _throw(err) { step(\"throw\", err); } _next(); }); }; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* eslint-disable */\nimport UploadImage from '../../components/UploadImage';\nimport Http from '@/http';\nexport default {\n  props: ['item'],\n  data: function data() {\n    return {\n      dialog: false,\n      valid: true,\n      name: '',\n      nameRules: [function (v) {\n        return !!v || '请填写名称';\n      }, function (v) {\n        return v && v.length <= 20 || '最多20个字';\n      }],\n      url: '',\n      weight: '',\n      weightRules: [function (v) {\n        return !!v || v === 0 || '请填写权重';\n      }, function (v) {\n        return /^[0-9]*$/.test(v) || '数值越小，权重越高，优先展示';\n      }],\n      imgs: [],\n      submitLoading: false\n    };\n  },\n  methods: {\n    submit: function () {\n      var _submit = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var reg, isUrl, img, param, res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.url) {\n                  _context.next = 6;\n                  break;\n                }\n\n                reg = /(((http|https)\\:\\/\\/)|(www)){1}[a-zA-Z0-9\\.\\/\\?\\:@\\-_=#]+\\.([a-zA-Z0-9\\&\\.\\/\\?\\:@\\-_=#])*/g;\n                isUrl = reg.test(this.url);\n\n                if (isUrl) {\n                  _context.next = 6;\n                  break;\n                }\n\n                this.$store.dispatch('setAlert', {\n                  alert: true,\n                  alertContent: '请填写正确链接地址',\n                  alertType: 'warning'\n                });\n                return _context.abrupt(\"return\");\n\n              case 6:\n                img = this.$refs.uploadimage.previewImages[0];\n\n                if (img) {\n                  _context.next = 10;\n                  break;\n                }\n\n                this.$store.dispatch('setAlert', {\n                  alert: true,\n                  alertContent: '请上传图片',\n                  alertType: 'warning'\n                });\n                return _context.abrupt(\"return\");\n\n              case 10:\n                param = {\n                  image: img,\n                  url: this.url,\n                  name: this.name,\n                  weight: this.weight\n                };\n\n                if (!this.$refs.form.validate()) {\n                  _context.next = 27;\n                  break;\n                }\n\n                this.submitLoading = true;\n\n                if (!(this.item && this.item.id)) {\n                  _context.next = 21;\n                  break;\n                }\n\n                param.id = this.item.id;\n                param.mode = 'change_info';\n                _context.next = 18;\n                return Http.post('/travel/banner/options', param);\n\n              case 18:\n                res = _context.sent;\n                _context.next = 25;\n                break;\n\n              case 21:\n                param.mode = 'add_banner';\n                _context.next = 24;\n                return Http.post('/travel/banner/options', param);\n\n              case 24:\n                res = _context.sent;\n\n              case 25:\n                this.submitLoading = false;\n\n                if (res && res.data) {\n                  if (res.data.respcd === '0000') {\n                    this.$emit('ctrl');\n                    this.cancel();\n                    this.$store.dispatch('setAlert', {\n                      alert: true,\n                      alertContent: '操作成功',\n                      alertType: 'success'\n                    });\n                  } else {\n                    // 问题提示\n                    this.$store.dispatch('setAlert', {\n                      alert: true,\n                      alertContent: res.data.respmsg,\n                      alertType: 'error'\n                    });\n                  }\n                }\n\n              case 27:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function submit() {\n        return _submit.apply(this, arguments);\n      };\n    }(),\n    cancel: function cancel() {\n      this.dialog = false;\n      this.$refs.form.reset();\n      this.$refs.uploadimage.previewImages = [];\n      this.$refs.uploadimage.showAddBtn = true;\n    }\n  },\n  watch: {\n    'dialog': function dialog(val) {\n      if (val && this.item) {\n        this.name = this.item.name;\n        this.url = this.item.url;\n        this.weight = this.item.weight;\n        this.$refs.uploadimage.previewImages.splice(0, 1, this.item.image);\n        this.$refs.uploadimage.showAddBtn = false;\n      }\n\n      if (!val) {\n        this.cancel();\n      }\n    }\n  },\n  components: {\n    UploadImage: UploadImage\n  }\n};",{"version":3,"sources":["BannerAdd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA,OAAA,WAAA,MAAA,8BAAA;AACA,OAAA,IAAA,MAAA,QAAA;AACA,eAAA;AACA,SAAA,CACA,MADA,CADA;AAIA,MAJA,kBAIA;AACA,WAAA;AACA,cAAA,KADA;AAEA,aAAA,IAFA;AAGA,YAAA,EAHA;AAIA,iBAAA,CACA;AAAA,eAAA,CAAA,CAAA,CAAA,IAAA,OAAA;AAAA,OADA,EAEA;AAAA,eAAA,KAAA,EAAA,MAAA,IAAA,EAAA,IAAA,QAAA;AAAA,OAFA,CAJA;AAQA,WAAA,EARA;AASA,cAAA,EATA;AAUA,mBAAA,CACA;AAAA,eAAA,CAAA,CAAA,CAAA,IAAA,MAAA,CAAA,IAAA,OAAA;AAAA,OADA,EAEA;AAAA,eAAA,WAAA,IAAA,CAAA,CAAA,KAAA,gBAAA;AAAA,OAFA,CAVA;AAcA,YAAA,EAdA;AAeA,qBAAA;AAfA,KAAA;AAiBA,GAtBA;AAuBA,WAAA;AACA,UADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEA,KAAA,GAFA;AAAA;AAAA;AAAA;;AAGA,mBAHA,GAGA,4FAHA;AAIA,qBAJA,GAIA,IAAA,IAAA,CAAA,KAAA,GAAA,CAJA;;AAAA,oBAKA,KALA;AAAA;AAAA;AAAA;;AAMA,qBAAA,MAAA,CAAA,QAAA,CAAA,UAAA,EAAA;AACA,yBAAA,IADA;AAEA,gCAAA,WAFA;AAGA,6BAAA;AAHA,iBAAA;AANA;;AAAA;AAcA,mBAdA,GAcA,KAAA,KAAA,CAAA,WAAA,CAAA,aAAA,CAAA,CAAA,CAdA;;AAAA,oBAeA,GAfA;AAAA;AAAA;AAAA;;AAgBA,qBAAA,MAAA,CAAA,QAAA,CAAA,UAAA,EAAA;AACA,yBAAA,IADA;AAEA,gCAAA,OAFA;AAGA,6BAAA;AAHA,iBAAA;AAhBA;;AAAA;AAuBA,qBAvBA,GAuBA;AACA,yBAAA,GADA;AAEA,uBAAA,KAAA,GAFA;AAGA,wBAAA,KAAA,IAHA;AAIA,0BAAA,KAAA;AAJA,iBAvBA;;AAAA,qBA8BA,KAAA,KAAA,CAAA,IAAA,CAAA,QAAA,EA9BA;AAAA;AAAA;AAAA;;AA+BA,qBAAA,aAAA,GAAA,IAAA;;AA/BA,sBAgCA,KAAA,IAAA,IAAA,KAAA,IAAA,CAAA,EAhCA;AAAA;AAAA;AAAA;;AAiCA,sBAAA,EAAA,GAAA,KAAA,IAAA,CAAA,EAAA;AACA,sBAAA,IAAA,GAAA,aAAA;AAlCA;AAAA,uBAmCA,KAAA,IAAA,CAAA,wBAAA,EAAA,KAAA,CAnCA;;AAAA;AAmCA,mBAnCA;AAAA;AAAA;;AAAA;AAqCA,sBAAA,IAAA,GAAA,YAAA;AArCA;AAAA,uBAsCA,KAAA,IAAA,CAAA,wBAAA,EAAA,KAAA,CAtCA;;AAAA;AAsCA,mBAtCA;;AAAA;AAwCA,qBAAA,aAAA,GAAA,KAAA;;AACA,oBAAA,OAAA,IAAA,IAAA,EAAA;AACA,sBAAA,IAAA,IAAA,CAAA,MAAA,KAAA,MAAA,EAAA;AACA,yBAAA,KAAA,CAAA,MAAA;AACA,yBAAA,MAAA;AACA,yBAAA,MAAA,CAAA,QAAA,CAAA,UAAA,EAAA;AACA,6BAAA,IADA;AAEA,oCAAA,MAFA;AAGA,iCAAA;AAHA,qBAAA;AAKA,mBARA,MAQA;AACA;AACA,yBAAA,MAAA,CAAA,QAAA,CAAA,UAAA,EAAA;AACA,6BAAA,IADA;AAEA,oCAAA,IAAA,IAAA,CAAA,OAFA;AAGA,iCAAA;AAHA,qBAAA;AAKA;AACA;;AA1DA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AA6DA,UA7DA,oBA6DA;AACA,WAAA,MAAA,GAAA,KAAA;AACA,WAAA,KAAA,CAAA,IAAA,CAAA,KAAA;AACA,WAAA,KAAA,CAAA,WAAA,CAAA,aAAA,GAAA,EAAA;AACA,WAAA,KAAA,CAAA,WAAA,CAAA,UAAA,GAAA,IAAA;AACA;AAlEA,GAvBA;AA2FA,SAAA;AACA,cAAA,gBAAA,GAAA,EAAA;AACA,UAAA,OAAA,KAAA,IAAA,EAAA;AACA,aAAA,IAAA,GAAA,KAAA,IAAA,CAAA,IAAA;AACA,aAAA,GAAA,GAAA,KAAA,IAAA,CAAA,GAAA;AACA,aAAA,MAAA,GAAA,KAAA,IAAA,CAAA,MAAA;AACA,aAAA,KAAA,CAAA,WAAA,CAAA,aAAA,CAAA,MAAA,CAAA,CAAA,EAAA,CAAA,EAAA,KAAA,IAAA,CAAA,KAAA;AACA,aAAA,KAAA,CAAA,WAAA,CAAA,UAAA,GAAA,KAAA;AACA;;AACA,UAAA,CAAA,GAAA,EAAA;AACA,aAAA,MAAA;AACA;AACA;AAZA,GA3FA;AAyGA,cAAA;AACA;AADA;AAzGA,CAAA","sourcesContent":["<template>\n  <v-layout row :class=\"item ? 'justify-center': 'justify-end'\">\n    <v-dialog v-model=\"dialog\" fullscreen hide-overlay transition=\"dialog-bottom-transition\">\n      <v-icon slot=\"activator\" color=\"primary\" small v-if=\"item\">\n        edit\n      </v-icon>\n      <v-btn slot=\"activator\" color=\"primary\" dark v-else>新增banner</v-btn>\n      <v-toolbar dark color=\"primary\" class=\"cus-toolbar\">\n        <v-toolbar-title align-self-center v-if=\"item\">编辑BANNER</v-toolbar-title>\n        <v-toolbar-title align-self-center v-else>新增BANNER</v-toolbar-title>\n        <v-btn icon dark @click.native=\"dialog = false\">\n          <v-icon>close</v-icon>\n        </v-btn>\n      </v-toolbar>\n      <v-form ref=\"form\" v-model=\"valid\" lazy-validation class=\"banner-form\">\n        <v-text-field\n          v-model=\"name\"\n          :rules=\"nameRules\"\n          :counter=\"20\"\n          label=\"名称\"\n          required\n        ></v-text-field>\n        <v-layout row align-end>\n          <uploadImage ref=\"uploadimage\" :maxNumber=\"1\" class=\"mr-2\" label=\"图片\"/>\n          <p class=\"ma-0 pa-0 line-h-50\"><span>*&nbsp;</span>jpg格式，200k，推荐尺寸750*256</p>\n        </v-layout>\n        <v-text-field\n          v-model=\"url\"\n          label=\"链接\"\n        ></v-text-field>\n        <v-text-field\n          v-model=\"weight\"\n          :rules=\"weightRules\"\n          label=\"权重\"\n          required\n        ></v-text-field>\n        <v-btn\n          :disabled=\"!valid\"\n          @click=\"submit\"\n          color=\"primary\"\n          :loading=\"submitLoading\"\n        >\n          保存\n        </v-btn>\n        <v-btn @click=\"cancel\">取消</v-btn>\n      </v-form>\n    </v-dialog>\n  </v-layout>\n</template>\n<script>\n/* eslint-disable */\nimport UploadImage from '../../components/UploadImage'\nimport Http from '@/http'\nexport default {\n  props: [\n    'item'\n  ],\n  data () {\n    return {\n      dialog: false,\n      valid: true,\n      name: '',\n      nameRules: [\n        v => !!v || '请填写名称',\n        v => (v && v.length <= 20) || '最多20个字'\n      ],\n      url: '',\n      weight: '',\n      weightRules: [\n        v => !!v || v === 0 || '请填写权重',\n        v => /^[0-9]*$/.test(v) || '数值越小，权重越高，优先展示'\n      ],\n      imgs: [],\n      submitLoading: false\n    }\n  },\n  methods: {\n    async submit () {\n      if (this.url) {\n        let reg = /(((http|https)\\:\\/\\/)|(www)){1}[a-zA-Z0-9\\.\\/\\?\\:@\\-_=#]+\\.([a-zA-Z0-9\\&\\.\\/\\?\\:@\\-_=#])*/g\n        let isUrl = reg.test(this.url)\n        if (!isUrl) {\n          this.$store.dispatch('setAlert', {\n            alert: true,\n            alertContent: '请填写正确链接地址',\n            alertType: 'warning'\n          })\n          return\n        }\n      }\n      let img = this.$refs.uploadimage.previewImages[0]\n      if (!img) {\n        this.$store.dispatch('setAlert', {\n          alert: true,\n          alertContent: '请上传图片',\n          alertType: 'warning'\n        })\n        return\n      }\n      let param = {\n        image: img,\n        url: this.url,\n        name: this.name,\n        weight: this.weight\n      }\n      let res\n      if (this.$refs.form.validate()) {\n        this.submitLoading = true\n        if (this.item && this.item.id) {\n          param.id = this.item.id\n          param.mode = 'change_info'\n          res = await Http.post('/travel/banner/options', param)\n        } else {\n          param.mode = 'add_banner'\n          res = await Http.post('/travel/banner/options', param)\n        }\n        this.submitLoading = false\n        if (res && res.data) {\n          if (res.data.respcd === '0000') {\n            this.$emit('ctrl')\n            this.cancel()\n            this.$store.dispatch('setAlert', {\n              alert: true,\n              alertContent: '操作成功',\n              alertType: 'success'\n            })\n          } else {\n            // 问题提示\n            this.$store.dispatch('setAlert', {\n              alert: true,\n              alertContent: res.data.respmsg,\n              alertType: 'error'\n            })\n          }\n        }\n      }\n    },\n    cancel () {\n      this.dialog = false\n      this.$refs.form.reset()\n      this.$refs.uploadimage.previewImages = []\n      this.$refs.uploadimage.showAddBtn = true\n    }\n  },\n  watch: {\n    'dialog': function (val) {\n      if (val && this.item) {\n        this.name = this.item.name\n        this.url = this.item.url\n        this.weight = this.item.weight\n        this.$refs.uploadimage.previewImages.splice(0, 1, this.item.image)\n        this.$refs.uploadimage.showAddBtn = false\n      }\n      if (!val) {\n        this.cancel()\n      }\n    }\n  },\n  components: {\n    UploadImage\n  }\n}\n</script>\n<style scoped>\n.line-h-50{line-height: 50px;}\n.text-field-cus{margin: 0 10px 0 50px;padding: 0;width: 300px;flex-grow: 0;flex-shrink: 0;}\n.layout-row-cus{width: 50%;margin: 0 auto;flex-grow: 0;}\n.banner-form{margin: 0 auto;}\n</style>\n"],"sourceRoot":"src/pages/welfare/views/common"}]}