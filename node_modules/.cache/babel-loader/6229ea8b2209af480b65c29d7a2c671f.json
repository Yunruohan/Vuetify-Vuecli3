{"remainingRequest":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js!/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dmsun/Desktop/workspace/solar/src/pages/oper/views/subscription.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dmsun/Desktop/workspace/solar/src/pages/oper/views/subscription.vue","mtime":1548236701000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// @ is an alias to /src\nimport qs from 'qs';\nexport default {\n  data: function data() {\n    return {\n      select: {\n        name: '',\n        value: ''\n      },\n      // 公众号下拉框的数据\n      apps: {},\n      appsArray: [],\n      // 通道的下拉框的数据\n      chnlcode: [],\n      chnlcodeObject: {},\n      // 关注归属的下拉框数据\n      belong: {},\n      belongArray: [],\n      // 配置类型的下拉框数据\n      confmodel: {},\n      confmodelArray: [],\n      // 上面搜索条件表单的配置\n      searchParams: {\n        appname: '',\n        main: '',\n        appid: '',\n        cid: '',\n        uid: ''\n      },\n      // 分页页数的选择\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      // 列表表头的配置\n      headers: [{\n        text: '主题名称',\n        value: 'main',\n        sortable: false\n      }, {\n        text: '微信渠道号',\n        value: 'cid',\n        sortable: false\n      }, {\n        text: '支付APPID',\n        value: 'pay_appid',\n        sortable: false\n      }, {\n        text: '支付目录',\n        value: 'menu',\n        sortable: false\n      }, {\n        text: '公众号名称',\n        value: 'appname',\n        sortable: false\n      }, {\n        text: '公众号APPID',\n        value: 'appid',\n        sortable: false\n      }, {\n        text: '商户ID',\n        value: 'uid',\n        sortable: false\n      }, {\n        text: '支付通道',\n        value: 'chnlcode',\n        sortable: false\n      }, {\n        text: '公众号归属',\n        value: 'belong',\n        sortable: false\n      }, {\n        text: '配置类型',\n        value: 'confmodel',\n        sortable: false\n      }, {\n        text: '操作',\n        value: 'status',\n        sortable: false\n      }],\n      isPending: false,\n      // 列表数据数组\n      desserts: [],\n      total: 10,\n      page: 1,\n      pageSize: 10,\n      // 控制对话框的显示\n      isShowDialog: false,\n      baseFormData: {\n        id: '',\n        chnlcode: '',\n        belong: '',\n        confmodel: '',\n        appkey: '',\n        uid: '',\n        main: '',\n        cid: '',\n        pay_appid: '',\n        menu: '',\n        appname: '',\n        appid: ''\n      },\n      // 控制小程序密钥是否支持输入\n      sessShow: false,\n      kind: 'POST',\n      // 控制公众号是否支持编辑\n      appNameInput: false,\n      iconShow: false,\n      appidInputControl: false,\n      // 编辑功能的标识\n      isEdited: false,\n      // 控制公众号下拉框是否支持编辑\n      appnameDisabled: false,\n      formRules: {\n        emptyRules: [function (v) {\n          return !!v || '该字段不能为空';\n        }],\n        numberRules: [function (v) {\n          return !isNaN(Number(v)) || '该字段不能为空';\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.fetchData();\n    this.appData();\n  },\n  methods: {\n    // 查询按钮方法\n    search: function search() {\n      this.pageSize = 10;\n      this.page = 1;\n      console.log(this.select);\n      this.fetchData();\n    },\n    // 列表数据请求的方法\n    fetchData: function fetchData() {\n      var _this = this;\n\n      this.isPending = true;\n      var params = {\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n\n      };\n      this.searchParams.chnlcode = this.select.name;\n      Object.assign(params, this.searchParams);\n      this.$http({\n        url: '/solar/v1/oper/mpconf/list',\n        method: 'GET',\n        params: params\n      }).then(function (res) {\n        _this.isPending = false;\n        _this.desserts = res.list;\n        _this.total = res.total;\n      });\n    },\n    // 公众号和渠道等下拉框的数据请求方法\n    appData: function appData() {\n      var _this2 = this;\n\n      this.$http({\n        url: '/solar/v1/oper/mpconf/configs',\n        method: 'GET'\n      }).then(function (res) {\n        _this2.apps = res.apps;\n        _this2.appsArray = Object.keys(res.apps);\n        _this2.belong = res.belong;\n        _this2.belongArray = _this2.arrayTran(res.belong);\n        _this2.chnlcode = res.chnlcode;\n        _this2.chnlcodeObject = _this2.objTran(res.chnlcode);\n        console.log(_this2.chnlcodeObject, 99);\n        _this2.confmodel = res.confmodel;\n        _this2.confmodelArray = _this2.arrayTran(res.confmodel);\n      });\n    },\n    // 新增按钮对应的方法\n    addPublic: function addPublic() {\n      this.isShowDialog = true;\n      this.appNameInput = false; // 下面俩个布尔值控制是否可编辑\n\n      this.appnameDisabled = false;\n      this.appidInputControl = false; // 编辑与下拉框的按钮\n\n      this.iconShow = false; // 编辑的标示至为false 意为新增\n\n      this.isEdited = false;\n      this.reset();\n    },\n    // 字典转数组的方法\n    arrayTran: function arrayTran(json) {\n      var array = [];\n      var keys = Object.keys(json);\n      var values = Object.values(json);\n\n      for (var i in keys) {\n        var item = {\n          name: +keys[i],\n          value: values[i]\n        };\n        array.push(item);\n      }\n\n      return array;\n    },\n    // 数组转字典的方法\n    objTran: function objTran(json) {\n      var c = {};\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = json[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var i = _step.value;\n          var key = i.name;\n          c[key] = i.value;\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return c;\n    },\n    // 控制小程序的输入框是否支持输入\n    sessShowControl: function sessShowControl() {\n      // 控制小程序密钥是否支持输入\n      this.sessShow = this.baseFormData.confmodel === 1;\n      this.iconShow = this.baseFormData.confmodel === 2 && !this.isEdited;\n      this.appidInputControl = this.baseFormData.confmodel === 2 && this.isEdited;\n\n      if (this.baseFormData.confmodel === 1) {\n        this.baseFormData.appkey = '';\n      }\n    },\n    // 选择下拉框中的公众号之后会有对应的appid\n    appidControl: function appidControl() {\n      this.baseFormData.appid = this.apps[this.baseFormData.appname];\n\n      if (this.baseFormData.appid) {\n        this.appidInputControl = true;\n      }\n    },\n    // 对话框关闭\n    close: function close() {\n      this.isShowDialog = false;\n    },\n    // 对话框的表单提交\n    submit: function submit() {\n      var _this3 = this;\n\n      if (!this.$refs.baseForm.validate()) {\n        return false;\n      }\n\n      var params = {};\n      Object.assign(params, this.baseFormData);\n      this.$http({\n        url: '/solar/v1/oper/mpconf/info',\n        method: this.kind,\n        params: params\n      }).then(function (res) {\n        if (res === 'error') {\n          return false;\n        }\n\n        _this3.isShowDialog = false;\n\n        _this3.fetchData();\n      });\n    },\n    changeDetails: function changeDetails(item) {\n      // 对话框展示\n      this.isShowDialog = true; // 编辑标识至为true\n\n      this.isEdited = true; // appid不能编辑\n\n      this.appidInputControl = true; // appname不能编辑\n\n      this.appNameInput = false;\n      this.appnameDisabled = true; // 对话框选择和输入框的切换按钮不显示\n\n      this.iconShow = false; // 控制是修改还是新增\n\n      this.kind = 'PUT';\n      this.baseFormData = _objectSpread({}, item);\n      this.baseFormData = Object.assign(this.baseFormData, {\n        chnlcode: +item.chnlcode\n      });\n      this.sessShow = this.baseFormData.confmodel === 1;\n    },\n    reset: function reset() {\n      this.$refs.baseForm.reset();\n    },\n    appnameInputControl: function appnameInputControl() {\n      this.appNameInput = !this.appNameInput;\n      this.baseFormData.appname = '';\n      this.baseFormData.appid = '';\n      this.appidInputControl = false;\n    },\n    downExcel: function downExcel() {\n      var params = {\n        mode: 'expo_excel',\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n\n      };\n      Object.assign(params, this.searchParams);\n      var agencyHost = process.env.NODE_ENV === 'development' ? '/host' : '';\n      window.location.href = \"\".concat(agencyHost) + \"/solar/v1/oper/mpconf/list?\".concat(qs.stringify(params));\n    },\n    reSearch: function reSearch() {\n      this.$refs.searchForm.reset(); // this.searchParams.appname = \"\"\n      // this.searchParams.appid = \"\"\n      // this.searchParams.cid = \"\"\n      // this.searchParams.uid = \"\"\n      // this.searchParams.main = \"\"\n\n      this.fetchData();\n    }\n  }\n};",{"version":3,"sources":["subscription.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"oper\">\n    <v-form ref=\"searchForm\" class=\"search-form elevation-1\">\n      <v-select\n        label=\"公众号\" hide-details\n        :items=\"Object.keys(apps)\"\n        clearable\n        v-model=\"searchParams.appname\"\n      >\n      </v-select>\n      <v-text-field label=\"主体名称\" hide-details v-model=\"searchParams.main\"/>\n      <v-text-field label=\"渠道号\" hide-details v-model=\"searchParams.cid\"/>\n      <v-text-field label=\"APPID\" hide-details v-model=\"searchParams.appid\"/>\n      <v-text-field label=\"商户ID\" hide-details v-model=\"searchParams.uid\"/>\n      <v-select\n        label=\"通道\" hide-details\n        v-model=\"select.name\"\n        clearable\n        :hint=\"`${select.value}, ${select.name}`\"\n        :items=\"chnlcode\"\n        item-text=\"value\"\n        item-value=\"name\"\n      >\n      </v-select>\n      <div style=\"text-align:right\">\n        <v-btn @click=\"search()\" color=\"primary\">查找</v-btn>\n        <v-btn @click=\"reSearch()\">重置</v-btn>\n      </div>\n    </v-form>\n    <div style=\"text-align:left;padding:20px 0 6px;\">\n      <v-btn @click=\"addPublic()\" color=\"primary\">新增</v-btn>\n      <v-btn @click=\"downExcel()\" color=\"accent\">导出</v-btn>\n    </div>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"desserts\"\n      :loading=\"isPending\"\n      hide-actions\n      class=\"elevation-1\"\n    >\n      <template slot=\"items\" slot-scope=\"props\">\n        <td>{{ props.item.main }}</td>\n        <td>{{ props.item.cid }}</td>\n        <td>{{ props.item.pay_appid }}</td>\n        <td>{{ props.item.menu }}</td>\n        <td>{{ props.item.appname }}</td>\n        <td>{{ props.item.appid }}</td>\n        <td>{{ props.item.uid }}</td>\n        <td>{{ chnlcodeObject[props.item.chnlcode] }}</td>\n        <td>{{ belong[props.item.belong] }}</td>\n        <td>{{ confmodel[props.item.confmodel] }}</td>\n        <td>\n          <v-btn flat icon color=\"primary\" class=\"mx-0\" @click=\"changeDetails(props.item)\">\n            <v-icon small>details</v-icon>\n          </v-btn>\n        </td>\n      </template>\n      <template slot=\"no-data\">\n        <p style=\"text-align:center;padding-top:16px;\">暂无数据</p>\n      </template>\n    </v-data-table>\n\n    <div class=\"pagination-container\">\n      <span class=\"pagination-total\">共 {{total}} 条</span>\n      <v-select\n        v-model=\"pageSize\"\n        :items=\"selectItems\"\n        @change=\"fetchData()\"\n        height=\"20\"\n        label=\"10页/条\"\n        solo\n      ></v-select>\n      <v-pagination\n        v-model=\"page\"\n        @input=\"fetchData()\"\n        :length=\"parseInt(total / pageSize) + 1\"\n        :total-visible=\"7\"\n      ></v-pagination>\n    </div>\n\n    <v-dialog\n      v-model=\"isShowDialog\"\n      width=\"50%\"\n      transition=\"dialog-bottom-transition\"\n    >\n    <v-card>\n      <v-card-title style=\"background:#00b3e3 !important;color: #fff\">\n        <span class=\"headline\">公众号配置明细</span>\n      </v-card-title>\n      <v-card-text>\n        <v-form ref=\"baseForm\" lazy-validation>\n         <v-container grid-list-md>\n            <v-layout wrap>\n              <v-flex xs12 sm4 md5 style=\"margin-right:10%\">\n                  <v-select\n                    label=\"支持通道\" hide-details\n                    v-model=\"baseFormData.chnlcode\"\n                    :hint=\"`${select.value}, ${select.name}`\"\n                    :items=\"chnlcode\"\n                    item-text=\"value\"\n                    item-value=\"name\"\n                    :rules=\"formRules.emptyRules\"\n                  >\n                  </v-select>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-select\n                    label=\"关注归属\" hide-details\n                    v-model=\"baseFormData.belong\"\n                    :hint=\"`${select.value}, ${select.name}`\"\n                    :items=\"belongArray\"\n                    item-text=\"value\"\n                    item-value=\"name\"\n                  >\n                </v-select>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-select\n                    label=\"配置类型\" hide-details\n                    v-model=\"baseFormData.confmodel\"\n                    @change=\"sessShowControl\"\n                    :hint=\"`${select.value}, ${select.name}`\"\n                    :items=\"confmodelArray\"\n                    item-text=\"value\"\n                    item-value=\"name\"\n                    :rules=\"formRules.emptyRules\"\n                  >\n                </v-select>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-text-field :disabled=\"sessShow\" label=\"小程序密钥\" v-model=\"baseFormData.appkey\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"商户ID\" :rules=\"formRules.emptyRules\" v-model=\"baseFormData.uid\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-text-field label=\"主体名称\" :rules=\"formRules.emptyRules\" v-model=\"baseFormData.main\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"微信渠道号\" :rules=\"formRules.emptyRules\" v-model=\"baseFormData.cid\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-text-field label=\"支付APPID\" :rules=\"formRules.emptyRules\" v-model=\"baseFormData.pay_appid\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"支持目录\" :rules=\"formRules.emptyRules\" v-model=\"baseFormData.menu\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 class=\"appNameInput\">\n                <v-text-field v-if=\"appNameInput\"  label=\"公众号配置\" v-model=\"baseFormData.appname\"/>\n                <v-select\n                    v-else\n                    label=\"公众号配置\" hide-details\n                    :disabled=\"appnameDisabled\"\n                    v-model=\"baseFormData.appname\"\n                    :items=\"appsArray\"\n                    @change=\"appidControl\"\n                  >\n                </v-select>\n                <v-btn @click=\"appnameInputControl()\" flat icon color=\"info\" v-if=\"iconShow\">\n                  <v-icon>autorenew</v-icon>\n                </v-btn>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field :disabled=\"appidInputControl\" label=\"公众号APPID\" v-model=\"baseFormData.appid\"/>\n              </v-flex>\n            </v-layout>\n          </v-container>\n        </v-form>\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn color=\"blue darken-1\" flat @click=\"close()\">关闭</v-btn>\n        <v-btn color=\"primary\" @click=\"submit()\">提交</v-btn>\n      </v-card-actions>\n    </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport qs from 'qs'\nexport default {\n  data () {\n    return {\n      select: { name: '', value: '' },\n      // 公众号下拉框的数据\n      apps: {},\n      appsArray: [],\n      // 通道的下拉框的数据\n      chnlcode: [],\n      chnlcodeObject: {},\n      // 关注归属的下拉框数据\n      belong: {},\n      belongArray: [],\n      // 配置类型的下拉框数据\n      confmodel: {},\n      confmodelArray: [],\n      // 上面搜索条件表单的配置\n      searchParams: {\n        appname: '',\n        main: '',\n        appid: '',\n        cid: '',\n        uid: ''\n      },\n      // 分页页数的选择\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      // 列表表头的配置\n      headers: [\n        { text: '主题名称', value: 'main', sortable: false },\n        { text: '微信渠道号', value: 'cid', sortable: false },\n        { text: '支付APPID', value: 'pay_appid', sortable: false },\n        { text: '支付目录', value: 'menu', sortable: false },\n        { text: '公众号名称', value: 'appname', sortable: false },\n        { text: '公众号APPID', value: 'appid', sortable: false },\n        { text: '商户ID', value: 'uid', sortable: false },\n        { text: '支付通道', value: 'chnlcode', sortable: false },\n        { text: '公众号归属', value: 'belong', sortable: false },\n        { text: '配置类型', value: 'confmodel', sortable: false },\n        { text: '操作', value: 'status', sortable: false }\n      ],\n      isPending: false,\n      // 列表数据数组\n      desserts: [],\n      total: 10,\n      page: 1,\n      pageSize: 10,\n      // 控制对话框的显示\n      isShowDialog: false,\n      baseFormData: {\n        id: '',\n        chnlcode: '',\n        belong: '',\n        confmodel: '',\n        appkey: '',\n        uid: '',\n        main: '',\n        cid: '',\n        pay_appid: '',\n        menu: '',\n        appname: '',\n        appid: ''\n      },\n      // 控制小程序密钥是否支持输入\n      sessShow: false,\n      kind: 'POST',\n      // 控制公众号是否支持编辑\n      appNameInput: false,\n      iconShow: false,\n      appidInputControl: false,\n      // 编辑功能的标识\n      isEdited: false,\n      // 控制公众号下拉框是否支持编辑\n      appnameDisabled: false,\n      formRules: {\n        emptyRules: [\n          v => !!v || '该字段不能为空'\n        ],\n        numberRules: [\n          v => !isNaN(Number(v)) || '该字段不能为空'\n        ]\n      }\n    }\n  },\n  created () {\n    this.fetchData()\n    this.appData()\n  },\n  methods: {\n    // 查询按钮方法\n    search () {\n      this.pageSize = 10\n      this.page = 1\n      console.log(this.select)\n      this.fetchData()\n    },\n    // 列表数据请求的方法\n    fetchData () {\n      this.isPending = true\n      let params = {\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n      }\n      this.searchParams.chnlcode = this.select.name\n      Object.assign(params, this.searchParams)\n      this.$http({\n        url: '/solar/v1/oper/mpconf/list',\n        method: 'GET',\n        params\n      }).then(res => {\n        this.isPending = false\n        this.desserts = res.list\n        this.total = res.total\n      })\n    },\n    // 公众号和渠道等下拉框的数据请求方法\n    appData () {\n      this.$http({\n        url: '/solar/v1/oper/mpconf/configs',\n        method: 'GET'\n      }).then(res => {\n        this.apps = res.apps\n        this.appsArray = Object.keys(res.apps)\n        this.belong = res.belong\n        this.belongArray = this.arrayTran(res.belong)\n        this.chnlcode = res.chnlcode\n        this.chnlcodeObject = this.objTran(res.chnlcode)\n        console.log(this.chnlcodeObject, 99)\n        this.confmodel = res.confmodel\n        this.confmodelArray = this.arrayTran(res.confmodel)\n      })\n    },\n    // 新增按钮对应的方法\n    addPublic () {\n      this.isShowDialog = true\n      this.appNameInput = false\n      // 下面俩个布尔值控制是否可编辑\n      this.appnameDisabled = false\n      this.appidInputControl = false\n      // 编辑与下拉框的按钮\n      this.iconShow = false\n      // 编辑的标示至为false 意为新增\n      this.isEdited = false\n      this.reset()\n    },\n    // 字典转数组的方法\n    arrayTran(json) {\n      let array = []\n      let keys = Object.keys(json)\n      let values = Object.values(json)\n      for (let i in keys) {\n        let item = {\n          name: +keys[i],\n          value: values[i]\n        }\n        array.push(item)\n      }\n      return array\n    },\n    // 数组转字典的方法\n    objTran(json) {\n      let c = {}\n      for (let i of json) {\n        let key = i.name\n        c[key] = i.value\n      }\n      return c\n    },\n    // 控制小程序的输入框是否支持输入\n    sessShowControl() {\n      // 控制小程序密钥是否支持输入\n      this.sessShow = this.baseFormData.confmodel === 1\n      this.iconShow = this.baseFormData.confmodel === 2 && !this.isEdited\n      this.appidInputControl = this.baseFormData.confmodel === 2 && this.isEdited\n      if(this.baseFormData.confmodel === 1) {\n        this.baseFormData.appkey = ''\n      }\n    },\n    // 选择下拉框中的公众号之后会有对应的appid\n    appidControl() {\n      this.baseFormData.appid = this.apps[this.baseFormData.appname]\n      if (this.baseFormData.appid) {\n        this.appidInputControl = true\n      }\n    },\n    // 对话框关闭\n    close() {\n      this.isShowDialog = false\n    },\n    // 对话框的表单提交\n    submit() {\n      if (!this.$refs.baseForm.validate()) {\n        return false\n      }\n      let params = {}\n      Object.assign(params, this.baseFormData)\n      this.$http({\n        url: '/solar/v1/oper/mpconf/info',\n        method: this.kind,\n        params\n      }).then(res => {\n        if (res === 'error') {\n          return false\n        }\n        this.isShowDialog = false\n        this.fetchData()\n      })\n    },\n    changeDetails(item) {\n      // 对话框展示\n      this.isShowDialog = true\n      // 编辑标识至为true\n      this.isEdited = true\n      // appid不能编辑\n      this.appidInputControl = true\n      // appname不能编辑\n      this.appNameInput = false\n      this.appnameDisabled = true\n      // 对话框选择和输入框的切换按钮不显示\n      this.iconShow = false\n      // 控制是修改还是新增\n      this.kind = 'PUT'\n      this.baseFormData = { ...item }\n      this.baseFormData = Object.assign(this.baseFormData, {\n        chnlcode: +item.chnlcode\n      })\n      this.sessShow = this.baseFormData.confmodel === 1\n    },\n    reset() {\n      this.$refs.baseForm.reset()\n    },\n    appnameInputControl() {\n      this.appNameInput = !this.appNameInput\n      this.baseFormData.appname = ''\n      this.baseFormData.appid = ''\n      this.appidInputControl = false\n    },\n    downExcel() {\n      let params = {\n        mode: 'expo_excel',\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n      }\n      Object.assign(params, this.searchParams)\n      let agencyHost = process.env.NODE_ENV === 'development' ? '/host' : ''\n      window.location.href = `${agencyHost}`+`/solar/v1/oper/mpconf/list?${qs.stringify(params)}`\n    },\n    reSearch() {\n      this.$refs.searchForm.reset()\n      // this.searchParams.appname = \"\"\n      // this.searchParams.appid = \"\"\n      // this.searchParams.cid = \"\"\n      // this.searchParams.uid = \"\"\n      // this.searchParams.main = \"\"\n      this.fetchData()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .uploadImage {\n    vertical-align: top;\n  }\n  .search-form {\n    margin-top: 20px;\n    padding: 12px 20px;\n    background-color: #fff;\n    .v-text-field {\n      width: 240px;\n      margin-right: 30px;\n      margin-bottom: 15px;\n      display: inline-block;\n      vertical-align: middle;\n    }\n  }\n  .production-dialog .v-form {\n    background-color: #fff;\n    padding: 20px;\n  }\n  .oper .v-card__title {\n    text-align: center;\n  }\n  .appNameInput {\n    position: relative;\n    .v-btn {\n      position: absolute;\n      right: -40px;\n      top: 6px;\n    }\n  }\n</style>\n"],"sourceRoot":"src/pages/oper/views"}]}