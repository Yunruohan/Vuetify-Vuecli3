{"remainingRequest":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js!/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dmsun/Desktop/workspace/solar/src/pages/welfare/views/Store.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dmsun/Desktop/workspace/solar/src/pages/welfare/views/Store.vue","mtime":1547889925000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport qs from 'qs';\nexport default {\n  data: function data() {\n    return {\n      merchantId: '',\n      merchantName: '',\n      headers: [{\n        text: '门店名称',\n        value: 'name',\n        sortable: false\n      }, {\n        text: '地址',\n        value: 'area',\n        sortable: false\n      }, {\n        text: '电话',\n        value: 'logo',\n        sortable: false\n      }, {\n        text: '操作',\n        value: 'id',\n        sortable: false\n      }],\n      isPending: false,\n      desserts: [],\n      total: 0,\n      page: 1,\n      pageSize: 10,\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      isShowDialog: false,\n      // 新增弹框\n      isReadOnly: false,\n      // 详情\n      currentStoreId: '',\n      isUpdate: false,\n      // 修改\n      valid: false,\n      storeInfo: {\n        name: '',\n        address: '',\n        telephone: ''\n      },\n      formRulse: {\n        nameRules: [function (v) {\n          return !!v || '门店名称不能为空';\n        }],\n        addressRules: [function (v) {\n          return !!v || '地址不能为空';\n        }]\n      }\n    };\n  },\n  created: function created() {\n    var merchantId = this.$route.params.merchantId;\n    this.merchantId = merchantId;\n    this.merchantName = window.sessionStorage.getItem('merchantName');\n    this.fetchData(merchantId);\n  },\n  methods: {\n    fetchData: function fetchData(merchantId) {\n      var _this = this;\n\n      this.isPending = true;\n      this.$http({\n        url: '/travel/store/info',\n        method: 'GET',\n        params: {\n          userid: this.merchantId,\n          page: this.page - 1,\n          pageSize: this.pageSize\n        }\n      }).then(function (response) {\n        _this.isPending = false;\n        var res = response.data;\n\n        if (res.respcd === '0000') {\n          _this.desserts = res.data.list;\n          _this.total = res.data.total;\n        }\n      });\n    },\n    addStore: function addStore() {\n      this.isShowDialog = true;\n      this.isUpdate = false;\n      this.isReadOnly = false;\n      this.$refs.form.reset();\n    },\n    viewStore: function viewStore(info) {\n      this.isReadOnly = true;\n      this.updateStore(info);\n    },\n    updateStore: function updateStore(info) {\n      this.isShowDialog = true;\n      this.isUpdate = true;\n      this.currentStoreId = info.id;\n      this.storeInfo.name = info.name;\n      this.storeInfo.address = info.address;\n      this.storeInfo.telephone = info.telephone;\n    },\n    update: function update() {\n      this.isReadOnly = false;\n    },\n    submit: function submit() {\n      var _this2 = this;\n\n      var mode = this.isUpdate ? 'change_store' : 'add_store';\n      var data = {\n        mode: mode\n      };\n\n      if (this.isUpdate) {\n        data.id = this.currentStoreId;\n        data.name = this.storeInfo.name;\n        data.address = this.storeInfo.address;\n        data.telephone = this.storeInfo.telephone;\n      } else {\n        data.userid = this.merchantId;\n        data.stores = JSON.stringify(new Array(this.storeInfo));\n      }\n\n      this.$http({\n        url: '/travel/merchant/options',\n        method: 'POST',\n        data: qs.stringify(data)\n      }).then(function (response) {\n        var res = response.data;\n\n        if (res.respcd === '0000') {\n          _this2.isShowDialog = false;\n\n          _this2.fetchData();\n        } else {\n          _this2.$store.dispatch('setAlert', {\n            alert: true,\n            alertContent: res.respmsg,\n            alertType: 'error'\n          });\n        }\n      });\n    },\n    reset: function reset() {\n      this.$refs.form.reset();\n    }\n  }\n};",{"version":3,"sources":["Store.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"store\">\n    <v-layout align-center justify-space-between style=\"height:64px\">\n      <strong class=\"pl-2\">{{merchantName}}</strong>\n      <v-btn @click=\"addStore()\" color=\"primary\" dark>新增门店</v-btn>\n    </v-layout>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"desserts\"\n      :loading=\"isPending\"\n      hide-actions\n      class=\"elevation-1\"\n    >\n      <template slot=\"items\" slot-scope=\"props\">\n        <td>{{ props.item.name }}</td>\n        <td>{{ props.item.address }}</td>\n        <td>{{ props.item.telephone }}</td>\n        <td>\n          <v-btn flat icon color=\"primary\" class=\"mx-0\" @click=\"viewStore(props.item)\">\n            <v-icon small>details</v-icon>\n          </v-btn>\n        </td>\n      </template>\n      <template slot=\"no-data\">\n        <p style=\"text-align:center;padding-top:16px;\">暂无数据</p>\n      </template>\n    </v-data-table>\n    <div class=\"pagination-container\">\n      <span class=\"pagination-total\">共 {{total}} 条</span>\n      <v-select\n        v-model=\"pageSize\"\n        :items=\"selectItems\"\n        @change=\"fetchData()\"\n        height=\"20\"\n        label=\"10页/条\"\n        solo\n      ></v-select>\n      <v-pagination\n        v-model=\"page\"\n        @input=\"fetchData()\"\n        :length=\"parseInt(total / pageSize) + 1\"\n        :total-visible=\"7\"\n      ></v-pagination>\n    </div>\n\n    <v-dialog\n      v-model=\"isShowDialog\"\n      fullscreen\n      hide-overlay\n      transition=\"dialog-bottom-transition\"\n    >\n      <v-toolbar card dark color=\"primary\">\n        <v-toolbar-title v-if=\"isReadOnly\">门店详情</v-toolbar-title>\n        <v-toolbar-title v-else>{{isUpdate ? '修改门店' : '新增门店'}}</v-toolbar-title>\n        <v-spacer></v-spacer>\n        <v-btn icon dark @click.native=\"isShowDialog = false\">\n          <v-icon>close</v-icon>\n        </v-btn>\n      </v-toolbar>\n      <v-form ref=\"form\" v-model=\"valid\" lazy-validation>\n        <v-text-field label=\"门店名称\" :readonly=\"isReadOnly\" counter=\"40\" :rules=\"formRulse.nameRules\" v-model=\"storeInfo.name\"/>\n        <v-text-field label=\"地址\" :readonly=\"isReadOnly\" counter=\"100\" :rules=\"formRulse.addressRules\" v-model=\"storeInfo.address\"/>\n        <v-text-field label=\"电话\" :readonly=\"isReadOnly\" v-model=\"storeInfo.telephone\"/>\n        <div v-if=\"isReadOnly\" style=\"text-align:right;\">\n          <v-btn @click=\"update()\" color=\"primary\">编辑</v-btn>\n        </div>\n        <div v-else style=\"text-align:right;\">\n          <v-btn :disabled=\"!valid\" @click=\"submit()\" color=\"primary\">保存</v-btn>\n          <v-btn @click=\"reset()\">重置</v-btn>\n        </div>\n      </v-form>\n    </v-dialog>\n\n  </div>\n</template>\n\n<script>\nimport qs from 'qs'\nexport default {\n  data () {\n    return {\n      merchantId: '',\n      merchantName: '',\n      headers: [\n        { text: '门店名称', value: 'name', sortable: false },\n        { text: '地址', value: 'area', sortable: false },\n        { text: '电话', value: 'logo', sortable: false },\n        { text: '操作', value: 'id', sortable: false }\n      ],\n      isPending: false,\n      desserts: [],\n      total: 0,\n      page: 1,\n      pageSize: 10,\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      isShowDialog: false, // 新增弹框\n      isReadOnly: false, // 详情\n      currentStoreId: '',\n      isUpdate: false, // 修改\n      valid: false,\n      storeInfo: {\n        name: '',\n        address: '',\n        telephone: ''\n      },\n      formRulse: {\n        nameRules: [\n          v => !!v || '门店名称不能为空'\n        ],\n        addressRules: [\n          v => !!v || '地址不能为空'\n        ]\n      }\n    }\n  },\n  created () {\n    let merchantId = this.$route.params.merchantId\n    this.merchantId = merchantId\n    this.merchantName = window.sessionStorage.getItem('merchantName')\n    this.fetchData(merchantId)\n  },\n  methods: {\n    fetchData (merchantId) {\n      this.isPending = true\n      this.$http({\n        url: '/travel/store/info',\n        method: 'GET',\n        params: {\n          userid: this.merchantId,\n          page: this.page - 1,\n          pageSize: this.pageSize\n        }\n      }).then(response => {\n        this.isPending = false\n        let res = response.data\n        if (res.respcd === '0000') {\n          this.desserts = res.data.list\n          this.total = res.data.total\n        }\n      })\n    },\n    addStore () {\n      this.isShowDialog = true\n      this.isUpdate = false\n      this.isReadOnly = false\n      this.$refs.form.reset()\n    },\n    viewStore (info) {\n      this.isReadOnly = true\n      this.updateStore(info)\n    },\n    updateStore (info) {\n      this.isShowDialog = true\n      this.isUpdate = true\n      this.currentStoreId = info.id\n      this.storeInfo.name = info.name\n      this.storeInfo.address = info.address\n      this.storeInfo.telephone = info.telephone\n    },\n    update () {\n      this.isReadOnly = false\n    },\n    submit () {\n      let mode = this.isUpdate ? 'change_store' : 'add_store'\n      let data = {\n        mode\n      }\n      if (this.isUpdate) {\n        data.id = this.currentStoreId\n        data.name = this.storeInfo.name\n        data.address = this.storeInfo.address\n        data.telephone = this.storeInfo.telephone\n      } else {\n        data.userid = this.merchantId\n        data.stores = JSON.stringify(new Array(this.storeInfo))\n      }\n      this.$http({\n        url: '/travel/merchant/options',\n        method: 'POST',\n        data: qs.stringify(data)\n      }).then(response => {\n        let res = response.data\n        if (res.respcd === '0000') {\n          this.isShowDialog = false\n          this.fetchData()\n        } else {\n          this.$store.dispatch('setAlert', {\n            alert: true,\n            alertContent: res.respmsg,\n            alertType: 'error'\n          })\n        }\n      })\n    },\n    reset () {\n      this.$refs.form.reset()\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/pages/welfare/views"}]}