{"remainingRequest":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js!/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dmsun/Desktop/workspace/solar/src/pages/oper/views/org.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dmsun/Desktop/workspace/solar/src/pages/oper/views/org.vue","mtime":1547889925000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// @ is an alias to /src\nimport UploadImage from '../components/uploadImage';\nimport Comfirm from '@/components/Comfirm';\nimport qs from 'qs';\nimport timezones from '../utils/timezones';\nexport default {\n  components: {\n    UploadImage: UploadImage,\n    Comfirm: Comfirm\n  },\n  data: function data() {\n    return {\n      searchFormStatus: [{\n        value: '',\n        text: '全部'\n      }, {\n        value: 0,\n        text: '启用'\n      }, {\n        value: 1,\n        text: '停用'\n      }],\n      searchParams: {\n        name: '',\n        status: '',\n        qd_uid: ''\n      },\n      headers: [{\n        text: '服务商名称',\n        value: 'name',\n        sortable: false\n      }, {\n        text: '服务商ID',\n        value: 'qd_uid',\n        sortable: false\n      }, {\n        text: '登录账号',\n        value: 'username',\n        sortable: false\n      }, {\n        text: '服务商类型',\n        value: 'type',\n        sortable: false\n      }, {\n        text: '创建时间',\n        value: 'ctime',\n        sortable: false\n      }, {\n        text: '更新时间',\n        value: 'utime',\n        sortable: false\n      }, {\n        text: '状态',\n        value: 'status',\n        sortable: false\n      }, {\n        text: '详情',\n        value: 'id',\n        sortable: false\n      }],\n      isPending: false,\n      desserts: [],\n      total: 10,\n      page: 1,\n      pageSize: 10,\n      currentItem: {},\n      // 当前操作 table item\n      showComfirm: false,\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      isShowDialog: false,\n      // 新增机构弹框\n      isReadonly: false,\n      // 查看，详细\n      isUpdate: false,\n      // 修改\n      panel: [true, true, true],\n      currencys: [],\n      // 币种\n      countrys: [],\n      // 国家\n      orgTypes: [],\n      // 服务商类型\n      channels: [],\n      // 通道\n      baseInfo: {\n        // step1 基本信息\n        username: '',\n        mobile: '',\n        currency: ''\n      },\n      formRules: {\n        emptyRules: [function (v) {\n          return !!v || '该字段不能为空';\n        }],\n        numberRules: [function (v) {\n          return !isNaN(Number(v)) || '该字段不能为空';\n        }]\n      },\n      financeInfo: {},\n      // photosValid: false,\n      // photos: {\n      //   id: '',\n      //   reverseId: '',\n      //   company: '',\n      //   business: ''\n      // },\n      productionHeaders: [{\n        text: '通道',\n        value: 'chnlname',\n        sortable: false\n      }, {\n        text: '产品',\n        value: 'trade_name',\n        sortable: false\n      }, {\n        text: '费率成本',\n        value: 'ratio',\n        sortable: false\n      }, {\n        text: '固定值成本',\n        value: 'fix_fee',\n        sortable: false\n      }, {\n        text: '状态',\n        value: 'status',\n        sortable: false\n      }, {\n        text: '操作',\n        value: 'operate',\n        sortable: false\n      }],\n      productions: [],\n      isShowProductionDialog: false,\n      isUpdateProduction: false,\n      // 编辑产品\n      productionFormValid: false,\n      currentChannelIndex: 0,\n      channelInfo: {},\n      channelFormRulse: {},\n      channelTrades: [] // 通道下的所有产品(交易方式)\n\n    };\n  },\n  filters: {\n    formatType: function formatType(number) {\n      var typeString = number === 1 ? '有资金管理能力' : '无资金管理能力';\n      return typeString;\n    }\n  },\n  created: function created() {\n    this.timezones = timezones;\n    this.fetchData();\n  },\n  methods: {\n    search: function search() {\n      this.pageSize = 10;\n      this.page = 1;\n      this.fetchData();\n    },\n    fetchData: function fetchData() {\n      var _this = this;\n\n      this.isPending = true;\n      var params = {\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n\n      };\n      Object.assign(params, this.searchParams);\n      this.$http({\n        url: '/solar/v1/org/user/list',\n        method: 'GET',\n        params: params\n      }).then(function (res) {\n        _this.isPending = false;\n        _this.desserts = res.list;\n        _this.total = res.total;\n      });\n    },\n    openOrgDialog: function openOrgDialog() {\n      this.$refs.baseForm.reset();\n      this.$refs.financeForm.reset();\n      this.productions = [];\n      this.isShowDialog = true;\n      this.isUpdate = false;\n      this.getConfigs();\n    },\n    getConfigs: function getConfigs() {\n      var _this2 = this;\n\n      this.$http({\n        url: '/solar/v1/org/configs',\n        method: 'GET'\n      }).then(function (res) {\n        _this2.currencys = res.currency;\n        _this2.countrys = res.country;\n        _this2.orgTypes = res.org_type;\n        _this2.channels = res.chnl;\n      });\n    },\n    channelName: function channelName(code) {\n      var channelName = '';\n      this.channels.map(function (item) {\n        if (item.chnlcode === code) {\n          channelName = item.text;\n        }\n      });\n      return channelName;\n    },\n    productionName: function productionName(type) {\n      var productionName = '';\n      this.channelTrades.map(function (item) {\n        if (item.trade_type === type) {\n          productionName = item.name;\n        }\n      });\n      return productionName;\n    },\n    selectChannel: function selectChannel(value) {\n      var _this3 = this;\n\n      this.$http({\n        url: '/solar/v1/org/trade_types',\n        method: 'GET',\n        params: {\n          chnlcode: value\n        }\n      }).then(function (res) {\n        _this3.channelTrades = res;\n      });\n    },\n    openProductionDialog: function openProductionDialog() {\n      this.isShowProductionDialog = true;\n      this.isUpdateProduction = false;\n      this.$refs.productionForm.reset(); // this.channelInfo = {}\n    },\n    editProductionDialog: function editProductionDialog(index, production) {\n      this.isShowProductionDialog = true;\n      this.isUpdateProduction = true;\n      this.selectChannel(production.chnlcode);\n      this.currentChannelIndex = index;\n      this.channelInfo = _objectSpread({}, production);\n    },\n    saveProduction: function saveProduction() {\n      if (!this.$refs.productionForm.validate()) {\n        return false;\n      }\n\n      var channelInfo = _objectSpread({}, this.channelInfo);\n\n      channelInfo.chnlname = this.channelName(channelInfo.chnlcode);\n      channelInfo.trade_name = this.productionName(channelInfo.trade_type);\n      channelInfo.status = 1;\n\n      if (this.isUpdateProduction) {\n        this.$set(this.productions, this.currentChannelIndex, channelInfo);\n      } else {\n        this.productions.push(channelInfo);\n      }\n\n      this.isShowProductionDialog = false;\n    },\n    deleteProduction: function deleteProduction(code) {\n      var _this4 = this;\n\n      this.productions.map(function (item, index) {\n        if (item.chnlcode === code) {\n          _this4.productions.splice(index, 1);\n        }\n      });\n    },\n    changeProductionStatus: function changeProductionStatus(value, code) {\n      this.productions.map(function (item) {\n        if (item.chnlcode === code) {\n          item.status = value;\n        }\n      });\n    },\n    viewDetails: function viewDetails(userid) {\n      var _this5 = this;\n\n      this.currentItem.id = userid;\n      this.getConfigs();\n      this.$http({\n        url: '/solar/v1/org/user/info',\n        method: 'GET',\n        params: {\n          userid: userid\n        }\n      }).then(function (res) {\n        _this5.isShowDialog = true;\n        _this5.isUpdate = true;\n        _this5.isReadonly = true;\n        _this5.baseInfo = {\n          short_name: res.short_name,\n          type: res.type,\n          name: res.name,\n          username: res.username,\n          legal_name: res.legal_name,\n          status: res.status,\n          mobile: res.mobile,\n          country: res.country,\n          email: res.email,\n          currency: res.currency,\n          address: res.address,\n          timezone: res.timezone\n        };\n        _this5.financeInfo = {\n          account_name: res.account_name,\n          bank_name: res.bank_name,\n          bank_account: res.bank_account,\n          bank_country: res.bank_country,\n          swift_code: res.swift_code,\n          brchbank_name: res.brchbank_name,\n          iban: res.iban,\n          brchbank_code: res.brchbank_code\n        };\n        _this5.productions = res.chnlinfos;\n      });\n    },\n    submitOrg: function submitOrg() {\n      var _this6 = this;\n\n      if (!this.$refs.baseForm.validate() || !this.$refs.financeForm.validate()) {\n        return false;\n      }\n\n      var params = Object.assign(this.baseInfo, this.financeInfo, {\n        chnlinfos: this.productions\n      });\n\n      if (this.isUpdate) {\n        params.userid = this.currentItem.id;\n      }\n\n      this.$http({\n        url: '/solar/v1/org/user/info',\n        method: this.isUpdate ? 'PUT' : 'POST',\n        data: params\n      }).then(function (response) {\n        if (response === 'error') {\n          return false;\n        }\n\n        _this6.isShowDialog = false;\n        var msg = _this6.isUpdate ? '修改成功' : '创建成功';\n\n        _this6.$emit('toast', msg, 'success'); // 创建成功，刷新列表\n\n\n        if (!_this6.isUpdate) {\n          _this6.$refs.searchForm.reset();\n\n          _this6.search();\n        }\n      });\n    },\n    beforeUpdateStatus: function beforeUpdateStatus(status, id) {\n      this.showComfirm = true;\n      this.currentItem = {\n        status: status,\n        id: id\n      };\n    },\n    cancelUpdateStatus: function cancelUpdateStatus() {\n      var _this7 = this;\n\n      this.showComfirm = false;\n      this.desserts.map(function (item) {\n        if (item.qd_uid === _this7.currentItem.id) {\n          item.status = _this7.currentItem.status === 1 ? 0 : 1; // 取消之后，重置原值\n        }\n      });\n    },\n    updateStatus: function updateStatus() {\n      var _this8 = this;\n\n      this.$http({\n        url: '/solar/v1/org/user/info',\n        method: 'PUT',\n        data: qs.stringify({\n          userid: this.currentItem.id,\n          status: this.currentItem.status\n        })\n      }).then(function (response) {\n        _this8.showComfirm = false;\n        _this8.showSnackbar = true;\n        _this8.snackbarText = '修改状态成功';\n      });\n    }\n  }\n};",{"version":3,"sources":["org.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"orgs\">\n    <v-layout align-center justify-space-between>\n      <v-form ref=\"searchForm\" class=\"search-form\">\n        <v-text-field label=\"服务商名称\" hide-details v-model=\"searchParams.name\"/>\n        <v-text-field label=\"登录账号\" hide-details v-model=\"searchParams.username\"/>\n        <v-select\n          label=\"状态\" hide-details\n          :items=\"searchFormStatus\"\n          v-model=\"searchParams.status\"\n        >\n        </v-select>\n        <v-btn @click=\"search()\" color=\"primary\">查找</v-btn>\n      </v-form>\n      <v-btn @click=\"openOrgDialog()\" color=\"primary\">添加服务商</v-btn>\n    </v-layout>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"desserts\"\n      :loading=\"isPending\"\n      hide-actions\n      class=\"elevation-1\"\n    >\n      <template slot=\"items\" slot-scope=\"props\">\n        <td>{{ props.item.name }}</td>\n        <td>{{ props.item.qd_uid }}</td>\n        <td>{{ props.item.username }}</td>\n        <td>{{ props.item.type | formatType}}</td>\n        <td>{{ props.item.ctime }}</td>\n        <td>{{ props.item.utime }}</td>\n        <td>\n          <v-switch @change=\"beforeUpdateStatus($event, props.item.qd_uid)\" v-model=\"props.item.status\" color=\"primary\" :messages=\"props.item.status === 0 ? '已启用' : '已停用'\"  :true-value=\"0\" :false-value=\"1\"></v-switch>\n        </td>\n        <td>\n          <v-btn flat icon color=\"primary\" class=\"mx-0\" @click=\"viewDetails(props.item.qd_uid)\">\n            <v-icon small>details</v-icon>\n          </v-btn>\n        </td>\n      </template>\n      <template slot=\"no-data\">\n        <p style=\"text-align:center;padding-top:16px;\">暂无数据</p>\n      </template>\n    </v-data-table>\n    <div class=\"pagination-container\">\n      <span class=\"pagination-total\">共 {{total}} 条</span>\n      <v-select\n        v-model=\"pageSize\"\n        :items=\"selectItems\"\n        @change=\"fetchData()\"\n        height=\"20\"\n        label=\"10页/条\"\n        solo\n      ></v-select>\n      <v-pagination\n        v-model=\"page\"\n        @input=\"fetchData()\"\n        :length=\"parseInt(total / pageSize) + 1\"\n        :total-visible=\"7\"\n      ></v-pagination>\n    </div>\n\n    <v-dialog\n      v-model=\"isShowDialog\"\n      fullscreen\n      hide-overlay\n      transition=\"dialog-bottom-transition\"\n    >\n      <v-toolbar card dark color=\"primary\">\n        <v-toolbar-title>{{isUpdate ? '修改服务商' : '添加服务商'}}</v-toolbar-title>\n        <v-spacer></v-spacer>\n        <v-btn icon dark @click.native=\"isShowDialog = false\">\n          <v-icon>close</v-icon>\n        </v-btn>\n      </v-toolbar>\n\n      <v-expansion-panel v-model=\"panel\" expand>\n        <v-expansion-panel-content>\n          <div slot=\"header\">基本信息</div>\n          <v-form ref=\"baseForm\" lazy-validation>\n            <v-text-field label=\"服务商名称\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.short_name\"/>\n            <v-select\n              v-model=\"baseInfo.type\"\n              :rules=\"formRules.emptyRules\"\n              :items=\"orgTypes\"\n              item-value=\"type\"\n              label=\"服务商类型\"\n            ></v-select>\n            <v-text-field label=\"公司名称\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.name\"/>\n            <v-text-field label=\"登录账号\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.username\"/>\n            <v-text-field label=\"法人姓名\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.legal_name\"/>\n            <v-select\n              label=\"状态\"\n              :items=\"[{\n                text: '启用',\n                value: 0\n              }, {\n                text: '停用',\n                value: 1\n              }]\"\n              v-model=\"baseInfo.status\"\n            >\n            </v-select>\n            <v-text-field label=\"联系电话\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.mobile\"/>\n            <v-select\n              v-model=\"baseInfo.country\"\n              :rules=\"formRules.emptyRules\"\n              :items=\"countrys\"\n              item-value=\"code\"\n              label=\"国家\"\n            ></v-select>\n            <v-text-field label=\"联系邮箱\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.email\"/>\n            <v-select\n              v-model=\"baseInfo.currency\"\n              :rules=\"formRules.emptyRules\"\n              :items=\"currencys\"\n              item-value=\"code\"\n              label=\"币种\"\n            ></v-select>\n            <v-text-field label=\"公司地址\" :rules=\"formRules.emptyRules\" v-model=\"baseInfo.address\"/>\n            <v-select\n              v-model=\"baseInfo.timezone\"\n              :rules=\"formRules.emptyRules\"\n              :items=\"timezones\"\n              label=\"时区\"\n            ></v-select>\n          </v-form>\n        </v-expansion-panel-content>\n        <v-expansion-panel-content>\n          <div slot=\"header\">财务信息</div>\n          <v-form ref=\"financeForm\" lazy-validation>\n            <v-text-field label=\"开户名称\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.account_name\"/>\n            <v-text-field label=\"开户银行名称\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.bank_name\"/>\n            <v-text-field label=\"银行账号\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.bank_account\"/>\n            <v-text-field label=\"银行所在国别\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.bank_country\"/>\n            <v-text-field label=\"SWIFT CODE\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.swift_code\"/>\n            <v-text-field label=\"支行名称\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.brchbank_name\"/>\n            <v-text-field label=\"IBAN No.\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.iban\"/>\n            <v-text-field label=\"支行代码\" :rules=\"formRules.emptyRules\" v-model=\"financeInfo.brchbank_code\"/>\n          </v-form>\n        </v-expansion-panel-content>\n        <v-expansion-panel-content>\n          <div slot=\"header\">产品信息</div>\n          <v-layout align-center justify-end>\n            <v-btn color=\"primary\" @click=\"openProductionDialog()\">添加通道</v-btn>\n          </v-layout>\n          <v-data-table\n            :headers=\"productionHeaders\"\n            :items=\"productions\"\n            hide-actions\n            class=\"elevation-1\"\n          >\n            <template slot=\"items\" slot-scope=\"props\">\n              <td>{{ props.item.chnlname }}</td>\n              <td>{{ props.item.trade_name }}</td>\n              <td>{{ props.item.ratio }}</td>\n              <td>{{ props.item.fix_fee }}分</td>\n              <td>\n                <v-switch @change=\"changeProductionStatus($event, props.item.chnlcode)\" v-model=\"props.item.status\" color=\"primary\" :messages=\"props.item.status === 1 ? '已启用' : '已停用'\"  :true-value=\"1\" :false-value=\"0\"></v-switch>\n              </td>\n              <td>\n                <v-btn flat icon color=\"primary\" class=\"mx-0\" @click=\"editProductionDialog(props.index, props.item)\">\n                  <v-icon small>edit</v-icon>\n                </v-btn>\n                <v-btn v-if=\"!isUpdate\" flat icon color=\"primary\" class=\"mx-0\" @click=\"deleteProduction(props.item.chnlcode)\">\n                  <v-icon small>highlight_off</v-icon>\n                </v-btn>\n              </td>\n            </template>\n            <template slot=\"no-data\">\n              <p style=\"text-align:center;padding-top:16px;\">暂无数据</p>\n            </template>\n          </v-data-table>\n        </v-expansion-panel-content>\n        <!--\n          <uploadImage :src=\"photos.id\" label=\"法人身份证正面\" ref=\"idUpload\"/>\n          <uploadImage :src=\"photos.reverseId\" label=\"法人身份证反面\" ref=\"reverseIdUpload\"/>\n          <uploadImage :src=\"photos.company\" label=\"公司注册证书\" ref=\"companyUpload\"/>\n          <uploadImage :src=\"photos.business\" label=\"商业登记证\" ref=\"businessUpload\"/>\n         -->\n      </v-expansion-panel>\n      <v-btn color=\"primary\" @click=\"submitOrg()\" class=\"mx-5 my-3\">保存</v-btn>\n    </v-dialog>\n    <v-dialog\n      v-model=\"isShowProductionDialog\"\n      max-width=\"500px\"\n      content-class=\"production-dialog\"\n    >\n      <v-toolbar card dark color=\"primary\">\n        <v-toolbar-title>{{isUpdateProduction ? '修改通道' : '添加通道'}}</v-toolbar-title>\n        <v-spacer></v-spacer>\n        <v-btn icon dark @click.native=\"isShowProductionDialog = false\">\n          <v-icon>close</v-icon>\n        </v-btn>\n      </v-toolbar>\n      <v-form ref=\"productionForm\" lazy-validation>\n        <v-select\n          ref=\"channel\"\n          label=\"通道\"\n          :items=\"channels\"\n          :disabled=\"isUpdateProduction\"\n          item-value=\"chnlcode\"\n          @change=\"selectChannel\"\n          v-model=\"channelInfo.chnlcode\"\n          :rules=\"formRules.emptyRules\"\n        ></v-select>\n        <v-select\n          label=\"产品\"\n          :items=\"channelTrades\"\n          item-text=\"name\"\n          item-value=\"trade_type\"\n          v-model=\"channelInfo.trade_type\"\n          :rules=\"formRules.emptyRules\"\n        ></v-select>\n        <v-text-field\n          v-model.number=\"channelInfo.ratio\"\n          label=\"费率成本\"\n          placeholder=\"示例：0.38%填写0.0038\"\n          type=\"number\"\n          :rules=\"formRules.numberRules\"\n        ></v-text-field>\n        <v-text-field\n          v-model.number=\"channelInfo.fix_fee\"\n          label=\"固定值成本\"\n          type=\"number\"\n          suffix=\"分\"\n          :rules=\"formRules.numberRules\"\n        ></v-text-field>\n        <v-btn color=\"primary\" @click=\"saveProduction()\">保存</v-btn>\n      </v-form>\n    </v-dialog>\n    <comfirm @okHandler=\"updateStatus()\" @cancelHandler=\"cancelUpdateStatus()\" :isVisiable=\"showComfirm\" :msg=\"currentItem.status === 0 ? '确定启用吗？' : '确定停用吗？'\" />\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport UploadImage from '../components/uploadImage'\nimport Comfirm from '@/components/Comfirm'\nimport qs from 'qs'\nimport timezones from '../utils/timezones'\nexport default {\n  components: {\n    UploadImage,\n    Comfirm\n  },\n  data () {\n    return {\n      searchFormStatus: [{\n        value: '',\n        text: '全部'\n      }, {\n        value: 0,\n        text: '启用'\n      }, {\n        value: 1,\n        text: '停用'\n      }],\n      searchParams: {\n        name: '',\n        status: '',\n        qd_uid: ''\n      },\n      headers: [\n        { text: '服务商名称', value: 'name', sortable: false },\n        { text: '服务商ID', value: 'qd_uid', sortable: false },\n        { text: '登录账号', value: 'username', sortable: false },\n        { text: '服务商类型', value: 'type', sortable: false },\n        { text: '创建时间', value: 'ctime', sortable: false },\n        { text: '更新时间', value: 'utime', sortable: false },\n        { text: '状态', value: 'status', sortable: false },\n        { text: '详情', value: 'id', sortable: false }\n      ],\n      isPending: false,\n      desserts: [],\n      total: 10,\n      page: 1,\n      pageSize: 10,\n      currentItem: {}, // 当前操作 table item\n      showComfirm: false,\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      isShowDialog: false, // 新增机构弹框\n      isReadonly: false, // 查看，详细\n      isUpdate: false, // 修改\n      panel: [true, true, true],\n      currencys: [], // 币种\n      countrys: [], // 国家\n      orgTypes: [], // 服务商类型\n      channels: [], // 通道\n      baseInfo: { // step1 基本信息\n        username: '',\n        mobile: '',\n        currency: ''\n      },\n      formRules: {\n        emptyRules: [\n          v => !!v || '该字段不能为空'\n        ],\n        numberRules: [\n          v => !isNaN(Number(v)) || '该字段不能为空'\n        ]\n      },\n      financeInfo: {},\n      // photosValid: false,\n      // photos: {\n      //   id: '',\n      //   reverseId: '',\n      //   company: '',\n      //   business: ''\n      // },\n      productionHeaders: [\n        { text: '通道', value: 'chnlname', sortable: false },\n        { text: '产品', value: 'trade_name', sortable: false },\n        { text: '费率成本', value: 'ratio', sortable: false },\n        { text: '固定值成本', value: 'fix_fee', sortable: false },\n        { text: '状态', value: 'status', sortable: false },\n        { text: '操作', value: 'operate', sortable: false }\n      ],\n      productions: [],\n      isShowProductionDialog: false,\n      isUpdateProduction: false, // 编辑产品\n      productionFormValid: false,\n      currentChannelIndex: 0,\n      channelInfo: {},\n      channelFormRulse: {},\n      channelTrades: [] // 通道下的所有产品(交易方式)\n    }\n  },\n  filters: {\n    formatType (number) {\n      let typeString = number === 1 ? '有资金管理能力' : '无资金管理能力'\n      return typeString\n    }\n  },\n  created () {\n    this.timezones = timezones\n    this.fetchData()\n  },\n  methods: {\n    search () {\n      this.pageSize = 10\n      this.page = 1\n      this.fetchData()\n    },\n    fetchData () {\n      this.isPending = true\n      let params = {\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n      }\n      Object.assign(params, this.searchParams)\n      this.$http({\n        url: '/solar/v1/org/user/list',\n        method: 'GET',\n        params\n      }).then(res => {\n        this.isPending = false\n        this.desserts = res.list\n        this.total = res.total\n      })\n    },\n    openOrgDialog () {\n      this.$refs.baseForm.reset()\n      this.$refs.financeForm.reset()\n      this.productions = []\n      this.isShowDialog = true\n      this.isUpdate = false\n      this.getConfigs()\n    },\n    getConfigs () {\n      this.$http({\n        url: '/solar/v1/org/configs',\n        method: 'GET'\n      }).then(res => {\n        this.currencys = res.currency\n        this.countrys = res.country\n        this.orgTypes = res.org_type\n        this.channels = res.chnl\n      })\n    },\n    channelName (code) {\n      let channelName = ''\n      this.channels.map((item) => {\n        if (item.chnlcode === code) {\n          channelName = item.text\n        }\n      })\n      return channelName\n    },\n    productionName (type) {\n      let productionName = ''\n      this.channelTrades.map((item) => {\n        if (item.trade_type === type) {\n          productionName = item.name\n        }\n      })\n      return productionName\n    },\n    selectChannel (value) {\n      this.$http({\n        url: '/solar/v1/org/trade_types',\n        method: 'GET',\n        params: {\n          chnlcode: value\n        }\n      }).then(res => {\n        this.channelTrades = res\n      })\n    },\n    openProductionDialog () {\n      this.isShowProductionDialog = true\n      this.isUpdateProduction = false\n      this.$refs.productionForm.reset()\n      // this.channelInfo = {}\n    },\n    editProductionDialog (index, production) {\n      this.isShowProductionDialog = true\n      this.isUpdateProduction = true\n      this.selectChannel(production.chnlcode)\n      this.currentChannelIndex = index\n      this.channelInfo = { ...production }\n    },\n    saveProduction () {\n      if (!this.$refs.productionForm.validate()) {\n        return false\n      }\n      let channelInfo = { ...this.channelInfo }\n      channelInfo.chnlname = this.channelName(channelInfo.chnlcode)\n      channelInfo.trade_name = this.productionName(channelInfo.trade_type)\n      channelInfo.status = 1\n      if (this.isUpdateProduction) {\n        this.$set(this.productions, this.currentChannelIndex, channelInfo)\n      } else {\n        this.productions.push(channelInfo)\n      }\n      this.isShowProductionDialog = false\n    },\n    deleteProduction (code) {\n      this.productions.map((item, index) => {\n        if (item.chnlcode === code) {\n          this.productions.splice(index, 1)\n        }\n      })\n    },\n    changeProductionStatus (value, code) {\n      this.productions.map((item) => {\n        if (item.chnlcode === code) {\n          item.status = value\n        }\n      })\n    },\n    viewDetails (userid) {\n      this.currentItem.id = userid\n      this.getConfigs()\n      this.$http({\n        url: '/solar/v1/org/user/info',\n        method: 'GET',\n        params: {\n          userid\n        }\n      }).then(res => {\n        this.isShowDialog = true\n        this.isUpdate = true\n        this.isReadonly = true\n        this.baseInfo = {\n          short_name: res.short_name,\n          type: res.type,\n          name: res.name,\n          username: res.username,\n          legal_name: res.legal_name,\n          status: res.status,\n          mobile: res.mobile,\n          country: res.country,\n          email: res.email,\n          currency: res.currency,\n          address: res.address,\n          timezone: res.timezone\n        }\n        this.financeInfo = {\n          account_name: res.account_name,\n          bank_name: res.bank_name,\n          bank_account: res.bank_account,\n          bank_country: res.bank_country,\n          swift_code: res.swift_code,\n          brchbank_name: res.brchbank_name,\n          iban: res.iban,\n          brchbank_code: res.brchbank_code\n        }\n        this.productions = res.chnlinfos\n      })\n    },\n    submitOrg () {\n      if (!this.$refs.baseForm.validate() || !this.$refs.financeForm.validate()) {\n        return false\n      }\n      let params = Object.assign(this.baseInfo, this.financeInfo, {\n        chnlinfos: this.productions\n      })\n      if (this.isUpdate) {\n        params.userid = this.currentItem.id\n      }\n      this.$http({\n        url: '/solar/v1/org/user/info',\n        method: this.isUpdate ? 'PUT' : 'POST',\n        data: params\n      }).then(response => {\n        if (response === 'error') {\n          return false\n        }\n        this.isShowDialog = false\n        let msg = this.isUpdate ? '修改成功' : '创建成功'\n        this.$emit('toast', msg, 'success')\n        // 创建成功，刷新列表\n        if (!this.isUpdate) {\n          this.$refs.searchForm.reset()\n          this.search()\n        }\n      })\n    },\n    beforeUpdateStatus (status, id) {\n      this.showComfirm = true\n      this.currentItem = {\n        status,\n        id\n      }\n    },\n    cancelUpdateStatus () {\n      this.showComfirm = false\n      this.desserts.map((item) => {\n        if (item.qd_uid === this.currentItem.id) {\n          item.status = this.currentItem.status === 1 ? 0 : 1 // 取消之后，重置原值\n        }\n      })\n    },\n    updateStatus () {\n      this.$http({\n        url: '/solar/v1/org/user/info',\n        method: 'PUT',\n        data: qs.stringify({\n          userid: this.currentItem.id,\n          status: this.currentItem.status\n        })\n      }).then(response => {\n        this.showComfirm = false\n        this.showSnackbar = true\n        this.snackbarText = '修改状态成功'\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .uploadImage {\n    vertical-align: top;\n  }\n  .search-form {\n    padding: 20px 0;\n    .v-text-field {\n      width: 240px;\n      margin-right: 30px;\n      margin-bottom: 15px;\n      display: inline-block;\n      vertical-align: middle;\n    }\n  }\n  .production-dialog .v-form {\n    background-color: #fff;\n    padding: 20px;\n  }\n</style>\n"],"sourceRoot":"src/pages/oper/views"}]}