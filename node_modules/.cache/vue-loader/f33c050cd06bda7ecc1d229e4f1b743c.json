{"remainingRequest":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dmsun/Desktop/workspace/solar/src/pages/welfare/views/common/BannerAdd.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dmsun/Desktop/workspace/solar/src/pages/welfare/views/common/BannerAdd.vue","mtime":1547889925000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* eslint-disable */\nimport UploadImage from '../../components/UploadImage'\nimport Http from '@/http'\nexport default {\n  props: [\n    'item'\n  ],\n  data () {\n    return {\n      dialog: false,\n      valid: true,\n      name: '',\n      nameRules: [\n        v => !!v || '请填写名称',\n        v => (v && v.length <= 20) || '最多20个字'\n      ],\n      url: '',\n      weight: '',\n      weightRules: [\n        v => !!v || v === 0 || '请填写权重',\n        v => /^[0-9]*$/.test(v) || '数值越小，权重越高，优先展示'\n      ],\n      imgs: [],\n      submitLoading: false\n    }\n  },\n  methods: {\n    async submit () {\n      if (this.url) {\n        let reg = /(((http|https)\\:\\/\\/)|(www)){1}[a-zA-Z0-9\\.\\/\\?\\:@\\-_=#]+\\.([a-zA-Z0-9\\&\\.\\/\\?\\:@\\-_=#])*/g\n        let isUrl = reg.test(this.url)\n        if (!isUrl) {\n          this.$store.dispatch('setAlert', {\n            alert: true,\n            alertContent: '请填写正确链接地址',\n            alertType: 'warning'\n          })\n          return\n        }\n      }\n      let img = this.$refs.uploadimage.previewImages[0]\n      if (!img) {\n        this.$store.dispatch('setAlert', {\n          alert: true,\n          alertContent: '请上传图片',\n          alertType: 'warning'\n        })\n        return\n      }\n      let param = {\n        image: img,\n        url: this.url,\n        name: this.name,\n        weight: this.weight\n      }\n      let res\n      if (this.$refs.form.validate()) {\n        this.submitLoading = true\n        if (this.item && this.item.id) {\n          param.id = this.item.id\n          param.mode = 'change_info'\n          res = await Http.post('/travel/banner/options', param)\n        } else {\n          param.mode = 'add_banner'\n          res = await Http.post('/travel/banner/options', param)\n        }\n        this.submitLoading = false\n        if (res && res.data) {\n          if (res.data.respcd === '0000') {\n            this.$emit('ctrl')\n            this.cancel()\n            this.$store.dispatch('setAlert', {\n              alert: true,\n              alertContent: '操作成功',\n              alertType: 'success'\n            })\n          } else {\n            // 问题提示\n            this.$store.dispatch('setAlert', {\n              alert: true,\n              alertContent: res.data.respmsg,\n              alertType: 'error'\n            })\n          }\n        }\n      }\n    },\n    cancel () {\n      this.dialog = false\n      this.$refs.form.reset()\n      this.$refs.uploadimage.previewImages = []\n      this.$refs.uploadimage.showAddBtn = true\n    }\n  },\n  watch: {\n    'dialog': function (val) {\n      if (val && this.item) {\n        this.name = this.item.name\n        this.url = this.item.url\n        this.weight = this.item.weight\n        this.$refs.uploadimage.previewImages.splice(0, 1, this.item.image)\n        this.$refs.uploadimage.showAddBtn = false\n      }\n      if (!val) {\n        this.cancel()\n      }\n    }\n  },\n  components: {\n    UploadImage\n  }\n}\n",{"version":3,"sources":["BannerAdd.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BannerAdd.vue","sourceRoot":"src/pages/welfare/views/common","sourcesContent":["<template>\n  <v-layout row :class=\"item ? 'justify-center': 'justify-end'\">\n    <v-dialog v-model=\"dialog\" fullscreen hide-overlay transition=\"dialog-bottom-transition\">\n      <v-icon slot=\"activator\" color=\"primary\" small v-if=\"item\">\n        edit\n      </v-icon>\n      <v-btn slot=\"activator\" color=\"primary\" dark v-else>新增banner</v-btn>\n      <v-toolbar dark color=\"primary\" class=\"cus-toolbar\">\n        <v-toolbar-title align-self-center v-if=\"item\">编辑BANNER</v-toolbar-title>\n        <v-toolbar-title align-self-center v-else>新增BANNER</v-toolbar-title>\n        <v-btn icon dark @click.native=\"dialog = false\">\n          <v-icon>close</v-icon>\n        </v-btn>\n      </v-toolbar>\n      <v-form ref=\"form\" v-model=\"valid\" lazy-validation class=\"banner-form\">\n        <v-text-field\n          v-model=\"name\"\n          :rules=\"nameRules\"\n          :counter=\"20\"\n          label=\"名称\"\n          required\n        ></v-text-field>\n        <v-layout row align-end>\n          <uploadImage ref=\"uploadimage\" :maxNumber=\"1\" class=\"mr-2\" label=\"图片\"/>\n          <p class=\"ma-0 pa-0 line-h-50\"><span>*&nbsp;</span>jpg格式，200k，推荐尺寸750*256</p>\n        </v-layout>\n        <v-text-field\n          v-model=\"url\"\n          label=\"链接\"\n        ></v-text-field>\n        <v-text-field\n          v-model=\"weight\"\n          :rules=\"weightRules\"\n          label=\"权重\"\n          required\n        ></v-text-field>\n        <v-btn\n          :disabled=\"!valid\"\n          @click=\"submit\"\n          color=\"primary\"\n          :loading=\"submitLoading\"\n        >\n          保存\n        </v-btn>\n        <v-btn @click=\"cancel\">取消</v-btn>\n      </v-form>\n    </v-dialog>\n  </v-layout>\n</template>\n<script>\n/* eslint-disable */\nimport UploadImage from '../../components/UploadImage'\nimport Http from '@/http'\nexport default {\n  props: [\n    'item'\n  ],\n  data () {\n    return {\n      dialog: false,\n      valid: true,\n      name: '',\n      nameRules: [\n        v => !!v || '请填写名称',\n        v => (v && v.length <= 20) || '最多20个字'\n      ],\n      url: '',\n      weight: '',\n      weightRules: [\n        v => !!v || v === 0 || '请填写权重',\n        v => /^[0-9]*$/.test(v) || '数值越小，权重越高，优先展示'\n      ],\n      imgs: [],\n      submitLoading: false\n    }\n  },\n  methods: {\n    async submit () {\n      if (this.url) {\n        let reg = /(((http|https)\\:\\/\\/)|(www)){1}[a-zA-Z0-9\\.\\/\\?\\:@\\-_=#]+\\.([a-zA-Z0-9\\&\\.\\/\\?\\:@\\-_=#])*/g\n        let isUrl = reg.test(this.url)\n        if (!isUrl) {\n          this.$store.dispatch('setAlert', {\n            alert: true,\n            alertContent: '请填写正确链接地址',\n            alertType: 'warning'\n          })\n          return\n        }\n      }\n      let img = this.$refs.uploadimage.previewImages[0]\n      if (!img) {\n        this.$store.dispatch('setAlert', {\n          alert: true,\n          alertContent: '请上传图片',\n          alertType: 'warning'\n        })\n        return\n      }\n      let param = {\n        image: img,\n        url: this.url,\n        name: this.name,\n        weight: this.weight\n      }\n      let res\n      if (this.$refs.form.validate()) {\n        this.submitLoading = true\n        if (this.item && this.item.id) {\n          param.id = this.item.id\n          param.mode = 'change_info'\n          res = await Http.post('/travel/banner/options', param)\n        } else {\n          param.mode = 'add_banner'\n          res = await Http.post('/travel/banner/options', param)\n        }\n        this.submitLoading = false\n        if (res && res.data) {\n          if (res.data.respcd === '0000') {\n            this.$emit('ctrl')\n            this.cancel()\n            this.$store.dispatch('setAlert', {\n              alert: true,\n              alertContent: '操作成功',\n              alertType: 'success'\n            })\n          } else {\n            // 问题提示\n            this.$store.dispatch('setAlert', {\n              alert: true,\n              alertContent: res.data.respmsg,\n              alertType: 'error'\n            })\n          }\n        }\n      }\n    },\n    cancel () {\n      this.dialog = false\n      this.$refs.form.reset()\n      this.$refs.uploadimage.previewImages = []\n      this.$refs.uploadimage.showAddBtn = true\n    }\n  },\n  watch: {\n    'dialog': function (val) {\n      if (val && this.item) {\n        this.name = this.item.name\n        this.url = this.item.url\n        this.weight = this.item.weight\n        this.$refs.uploadimage.previewImages.splice(0, 1, this.item.image)\n        this.$refs.uploadimage.showAddBtn = false\n      }\n      if (!val) {\n        this.cancel()\n      }\n    }\n  },\n  components: {\n    UploadImage\n  }\n}\n</script>\n<style scoped>\n.line-h-50{line-height: 50px;}\n.text-field-cus{margin: 0 10px 0 50px;padding: 0;width: 300px;flex-grow: 0;flex-shrink: 0;}\n.layout-row-cus{width: 50%;margin: 0 auto;flex-grow: 0;}\n.banner-form{margin: 0 auto;}\n</style>\n"]}]}