{"remainingRequest":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dmsun/Desktop/workspace/solar/src/pages/oper/views/subscription.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/dmsun/Desktop/workspace/solar/src/pages/oper/views/subscription.vue","mtime":1548222446000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/@vue/cli-service/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/cache-loader/dist/cjs.js","mtime":1547890140000},{"path":"/Users/dmsun/Desktop/workspace/solar/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.uploadImage {\n  vertical-align: top;\n}\n.search-form {\n  padding: 20px 0;\n  .v-text-field {\n    width: 240px;\n    margin-right: 30px;\n    margin-bottom: 15px;\n    display: inline-block;\n    vertical-align: middle;\n  }\n}\n.production-dialog .v-form {\n  background-color: #fff;\n  padding: 20px;\n}\n.oper .v-card__title {\n  text-align: center;\n}\n.appNameInput {\n  position: relative;\n  .v-btn {\n    position: absolute;\n    right: -40px;\n    top: 6px;\n  }\n}\n",{"version":3,"sources":["subscription.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"subscription.vue","sourceRoot":"src/pages/oper/views","sourcesContent":["<template>\n  <div class=\"oper\">\n    <v-form ref=\"searchForm\" class=\"search-form elevation-1\">\n      <v-select\n        label=\"公众号\" hide-details\n        :items=\"Object.keys(apps)\"\n        v-model=\"searchParams.appname\"\n      >\n      </v-select>\n      <v-text-field label=\"主体名称\" hide-details v-model=\"searchParams.main\"/>\n      <v-text-field label=\"渠道号\" hide-details v-model=\"searchParams.cid\"/>\n      <v-text-field label=\"APPID\" hide-details v-model=\"searchParams.appid\"/>\n      <v-text-field label=\"商户ID\" hide-details v-model=\"searchParams.uid\"/>\n      <v-select\n        label=\"通道\" hide-details\n        v-model=\"select.name\"\n        :hint=\"`${select.value}, ${select.name}`\"\n        :items=\"chnlcode\"\n        item-text=\"value\"\n        item-value=\"name\"\n      >\n      </v-select>\n      <div style=\"text-align:right\">\n        <v-btn @click=\"search()\" color=\"primary\">查找</v-btn>\n        <v-btn @click=\"reSearch()\">重置</v-btn>\n      </div>\n    </v-form>\n    <div style=\"text-align:right\">\n      <v-btn @click=\"addPublic()\" color=\"primary\">新增</v-btn>\n      <v-btn @click=\"downExcel()\" color=\"secondary\">导出</v-btn>\n    </div>\n    <v-data-table\n      :headers=\"headers\"\n      :items=\"desserts\"\n      :loading=\"isPending\"\n      hide-actions\n      class=\"elevation-1\"\n    >\n      <template slot=\"items\" slot-scope=\"props\">\n        <td>{{ props.item.main }}</td>\n        <td>{{ props.item.cid }}</td>\n        <td>{{ props.item.pay_appid }}</td>\n        <td>{{ props.item.menu }}</td>\n        <td>{{ props.item.appname }}</td>\n        <td>{{ props.item.appid }}</td>\n        <td>{{ props.item.id }}</td>\n        <td>{{ chnlcodeObject[props.item.chnlcode] }}</td>\n        <td>{{ belong[props.item.belong] }}</td>\n        <td>{{ confmodel[props.item.confmodel] }}</td>\n        <td>\n          <v-btn flat icon color=\"primary\" class=\"mx-0\" @click=\"changeDetails(props.item)\">\n            <v-icon small>details</v-icon>\n          </v-btn>\n        </td>\n      </template>\n      <template slot=\"no-data\">\n        <p style=\"text-align:center;padding-top:16px;\">暂无数据</p>\n      </template>\n    </v-data-table>\n\n    <div class=\"pagination-container\">\n      <span class=\"pagination-total\">共 {{total}} 条</span>\n      <v-select\n        v-model=\"pageSize\"\n        :items=\"selectItems\"\n        @change=\"fetchData()\"\n        height=\"20\"\n        label=\"10页/条\"\n        solo\n      ></v-select>\n      <v-pagination\n        v-model=\"page\"\n        @input=\"fetchData()\"\n        :length=\"parseInt(total / pageSize) + 1\"\n        :total-visible=\"7\"\n      ></v-pagination>\n    </div>\n\n    <v-dialog\n      v-model=\"isShowDialog\"\n      width=\"50%\"\n      transition=\"dialog-bottom-transition\"\n    >\n    <v-card>\n      <v-card-title style=\"background:#00b3e3 !important;color: #fff\">\n        <span class=\"headline\">公众号配置明细</span>\n      </v-card-title>\n      <v-card-text>\n        <v-form ref=\"baseForm\">\n         <v-container grid-list-md>\n            <v-layout wrap>\n              <v-flex xs12 sm4 md5 style=\"margin-right:10%\">\n                  <v-select\n                    label=\"支持通道\" hide-details\n                    v-model=\"baseFormData.chnlcode\"\n                    :hint=\"`${select.value}, ${select.name}`\"\n                    :items=\"chnlcode\"\n                    item-text=\"value\"\n                    item-value=\"name\"\n                  >\n                  </v-select>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-select\n                    label=\"关注归属\" hide-details\n                    v-model=\"baseFormData.belong\"\n                    :hint=\"`${select.value}, ${select.name}`\"\n                    :items=\"belongArray\"\n                    item-text=\"value\"\n                    item-value=\"name\"\n                  >\n                </v-select>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-select\n                    label=\"配置类型\" hide-details\n                    v-model=\"baseFormData.confmodel\"\n                    @change=\"sessShowControl\"\n                    :hint=\"`${select.value}, ${select.name}`\"\n                    :items=\"confmodelArray\"\n                    item-text=\"value\"\n                    item-value=\"name\"\n                  >\n                </v-select>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-text-field :disabled=\"sessShow\" label=\"小程序密钥\" v-model=\"baseFormData.appkey\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"商户ID\" v-model=\"baseFormData.uid\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-text-field label=\"主体名称\" v-model=\"baseFormData.main\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"微信渠道号\" v-model=\"baseFormData.cid\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5>\n                <v-text-field label=\"支付APPID\" v-model=\"baseFormData.pay_appid\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"支持目录\" v-model=\"baseFormData.menu\"/>\n              </v-flex>\n              <v-flex xs12 sm6 md5 class=\"appNameInput\">\n                <v-text-field v-if=\"appNameInput\" label=\"公众号配置\" v-model=\"baseFormData.appname\"/>\n                <v-select\n                    v-else\n                    label=\"公众号配置\" hide-details\n                    v-model=\"baseFormData.appname\"\n                    :items=\"appsArray\"\n                    @change=\"appidControl\"\n                  >\n                </v-select>\n                <v-btn @click=\"appnameInputControl\" flat icon color=\"info\" v-if=\"!iconShow\">\n                  <v-icon>autorenew</v-icon>\n                </v-btn>\n              </v-flex>\n              <v-flex xs12 sm6 md5 style=\"margin-right:10%\">\n                <v-text-field label=\"公众号APPID\" v-model=\"baseFormData.appid\"/>\n              </v-flex>\n            </v-layout>\n          </v-container>\n        </v-form>\n      </v-card-text>\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn color=\"blue darken-1\" flat @click=\"close()\">关闭</v-btn>\n        <v-btn color=\"primary\" @click=\"submit()\">提交</v-btn>\n      </v-card-actions>\n    </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport UploadImage from '../components/uploadImage'\nimport Comfirm from '@/components/Comfirm'\nimport qs from 'qs'\nimport timezones from '../utils/timezones'\nexport default {\n  components: {\n    UploadImage,\n    Comfirm\n  },\n  data () {\n    return {\n      select: { name: '', value: '' },\n      // 公众号下拉框的数据\n      apps: {},\n      appsArray: [],\n      // 通道的下拉框的数据\n      chnlcode: [],\n      chnlcodeObject: {},\n      // 关注归属的下拉框数据\n      belong: {},\n      belongArray: [],\n      // 配置类型的下拉框数据\n      confmodel: {},\n      confmodelArray: [],\n      // 上面搜索条件表单的配置\n      searchParams: {\n        appname: '',\n        main: '',\n        appid: '',\n        cid: '',\n        uid: '',\n      },\n      // 分页页数的选择\n      selectItems: [{\n        value: 10,\n        text: '10条/页'\n      }, {\n        value: 20,\n        text: '20条/页'\n      }, {\n        value: 50,\n        text: '50条/页'\n      }],\n      // 列表表头的配置\n      headers: [\n        { text: '主题名称', value: 'main', sortable: false },\n        { text: '微信渠道号', value: 'cid', sortable: false },\n        { text: '支付APPID', value: 'pay_appid', sortable: false },\n        { text: '支付目录', value: 'menu', sortable: false },\n        { text: '公众号名称', value: 'appname', sortable: false },\n        { text: '公众号APPID', value: 'appid', sortable: false },\n        { text: '商户ID', value: 'uid', sortable: false },\n        { text: '支付通道', value: 'chnlcode', sortable: false },\n        { text: '公众号归属', value: 'belong', sortable: false },\n        { text: '配置类型', value: 'confmodel', sortable: false },\n        { text: '操作', value: 'status', sortable: false }\n      ],\n      isPending: false,\n      // 列表数据数组\n      desserts: [],\n      total: 10,\n      page: 1,\n      pageSize: 10,\n      // 控制对话框的显示\n      isShowDialog: false,\n      baseFormData: {\n        id: '',\n        chnlcode: '',\n        belong: '',\n        confmodel: '',\n        appkey: '',\n        uid: '',\n        main: '',\n        cid: '',\n        pay_appid: '',\n        menu: '',\n        appname: '',\n        appid: ''\n      },\n      // 控制小程序密钥是否支持输入\n      sessShow: false,\n      kind: 'POST',\n      appNameInput: false,\n      iconShow: false\n    }\n  },\n  created () {\n    this.timezones = timezones\n    this.fetchData()\n    this.appData()\n  },\n  methods: {\n    // 查询按钮方法\n    search () {\n      this.pageSize = 10\n      this.page = 1\n      console.log(this.select)\n      this.fetchData()\n    },\n    // 列表数据请求的方法\n    fetchData () {\n      this.isPending = true\n      let params = {\n        size: this.pageSize,\n        page: this.page - 1, // 第一页 page = 0\n      }\n      this.searchParams.chnlcode = this.select.name\n      Object.assign(params, this.searchParams)\n      this.$http({\n        url: '/solar/v1/oper/mpconf/list',\n        method: 'GET',\n        params\n      }).then(res => {\n        this.isPending = false\n        this.desserts = res.list\n        this.total = res.total\n      })\n    },\n    // 公众号和渠道等下拉框的数据请求方法\n    appData () {\n      this.$http({\n        url: '/solar/v1/oper/mpconf/configs',\n        method: 'GET',\n      }).then(res => {\n        this.apps = res.apps\n        this.appsArray = Object.keys(res.apps)\n        this.belong = res.belong\n        this.belongArray = this.arrayTran(res.belong)\n        this.chnlcode = res.chnlcode\n        this.chnlcodeObject = this.objTran(res.chnlcode)\n        console.log(this.chnlcodeObject, 99)\n        this.confmodel = res.confmodel\n        this.confmodelArray = this.arrayTran(res.confmodel)\n      })\n    },\n    // 新增按钮对应的方法\n    addPublic () {\n      this.isShowDialog = true\n      this.reset()\n    },\n    // 字典转数组的方法\n    arrayTran(json) {\n      let array = []\n      let keys = Object.keys(json)\n      let values = Object.values(json)\n      for(let i in keys) {\n        let item = {\n          name: +keys[i],\n          value: values[i]\n        }\n        array.push(item)\n      }\n      return array\n    },\n    // 数组转字典的方法\n    objTran(json) {\n      let c = {}\n      for(let i of json) {\n        let key = i.name\n        c[key] = i.value\n      }\n      return c\n    },\n    // 控制小程序的输入框是否支持输入\n    sessShowControl() {\n      this.sessShow = this.baseFormData.confmodel === 1\n      this.iconShow = this.baseFormData.confmodel === 1\n    },\n    // 选择下拉框中的公众号之后会有对应的appid\n    appidControl() {\n      console.log(this.apps, 444)\n      this.baseFormData.appid = this.apps[this.baseFormData.appname]\n    },\n    // 对话框关闭\n    close() {\n      this.isShowDialog = false\n    },\n    // 对话框的表单提交\n    submit() {\n      let params ={}\n      Object.assign(params, this.baseFormData)\n      this.$http({\n        url: '/solar/v1/oper/mpconf/info',\n        method: this.kind,\n        params\n      }).then(res => {\n        this.isShowDialog = false\n        this.fetchData()\n      })\n    },\n    changeDetails(item) {\n      this.isShowDialog = true\n      this.kind = 'PUT'\n      this.baseFormData = { ...item }\n      this.baseFormData = Object.assign(this.baseFormData, {\n        chnlcode: +item.chnlcode\n      })\n      this.sessShow =  this.baseFormData.confmodel == \"1\"\n    },\n    reset() {\n      this.$refs.baseForm.reset()\n    },\n    appnameInputControl() {\n      this.appNameInput = !this.appNameInput\n    },\n    downExcel(){\n      let params = {\n        mode: 'expo_excel',\n        size: this.pageSize,\n        page: this.page - 1 // 第一页 page = 0\n      }\n      Object.assign(params, this.searchParams)\n      window.location.href = `/host/solar/v1/oper/mpconf/list?${qs.stringify(params)}`\n    },\n    reSearch() {\n      this.$refs.searchForm.reset()\n      // this.searchParams.appname = \"\"\n      // this.searchParams.appid = \"\"\n      // this.searchParams.cid = \"\"\n      // this.searchParams.uid = \"\"\n      // this.searchParams.main = \"\"\n      this.fetchData()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .uploadImage {\n    vertical-align: top;\n  }\n  .search-form {\n    padding: 20px 0;\n    .v-text-field {\n      width: 240px;\n      margin-right: 30px;\n      margin-bottom: 15px;\n      display: inline-block;\n      vertical-align: middle;\n    }\n  }\n  .production-dialog .v-form {\n    background-color: #fff;\n    padding: 20px;\n  }\n  .oper .v-card__title {\n    text-align: center;\n  }\n  .appNameInput {\n    position: relative;\n    .v-btn {\n      position: absolute;\n      right: -40px;\n      top: 6px;\n    }\n  }\n</style>\n"]}]}